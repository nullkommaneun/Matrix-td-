<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RESET</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="wrap">

  <!-- START SCREEN -->
  <section id="start-screen">
    <h1>RESET</h1>

    <div class="row cols-2">
      <!-- Profil -->
      <div class="panel">
        <h3>Profil</h3>
        <div class="muted">Kontext: <strong>Beziehungs-Aufarbeitung</strong> Â· Modus: <strong>Selbstreflexion</strong></div>
        <div class="sep"></div>

        <div class="stack" style="gap:10px;">
          <div class="inline">
            <label class="muted" for="name-input">Name:</label>
            <input id="name-input" placeholder="Nur Buchstaben (2â€“20)" pattern="[A-Za-zÃ„Ã–ÃœÃ¤Ã¶Ã¼ÃŸ]{2,20}" />
            <span id="name-ok" class="danger">âœ–</span>
          </div>

          <div class="inline">
            <span class="muted">Geschlecht:</span> <span id="gender-label">Divers</span>
            <button id="gender-toggle">Wechseln</button>
          </div>

          <div class="inline">
            <label class="muted" for="age-input">Alter:</label>
            <input id="age-input" type="number" min="10" max="99" value="18" style="width:90px;" />
          </div>

          <div class="inline">
            <span class="muted">Seed (optional):</span>
            <input id="seed-input" placeholder="z. B. 12345" style="min-width:180px;" />
            <button id="seed-dice" title="Seed wÃ¼rfeln">ðŸŽ²</button>
          </div>
        </div>
      </div>

      <!-- Attribute -->
      <div class="panel">
        <h3>Attribute â€” Punkte Ã¼brig: <span id="pts-left">10</span></h3>

        <div class="stat-row">
          <div>Selbstbild</div>
          <button data-stat="Selbstbild" data-delta="-1">âˆ’</button>
          <div id="stat-Selbstbild" style="text-align:center;">5</div>
          <button data-stat="Selbstbild" data-delta="1">+</button>
        </div>

        <div class="stat-row">
          <div>Regulation</div>
          <button data-stat="Regulation" data-delta="-1">âˆ’</button>
          <div id="stat-Regulation" style="text-align:center;">5</div>
          <button data-stat="Regulation" data-delta="1">+</button>
        </div>

        <div class="stat-row">
          <div>Klarheit</div>
          <button data-stat="Klarheit" data-delta="-1">âˆ’</button>
          <div id="stat-Klarheit" style="text-align:center;">5</div>
          <button data-stat="Klarheit" data-delta="1">+</button>
        </div>

        <div class="stat-row">
          <div>Grenzen</div>
          <button data-stat="Grenzen" data-delta="-1">âˆ’</button>
          <div id="stat-Grenzen" style="text-align:center;">5</div>
          <button data-stat="Grenzen" data-delta="1">+</button>
        </div>

        <div class="stat-row">
          <div>Zuversicht</div>
          <button data-stat="Zuversicht" data-delta="-1">âˆ’</button>
          <div id="stat-Zuversicht" style="text-align:center;">5</div>
          <button data-stat="Zuversicht" data-delta="1">+</button>
        </div>
      </div>
    </div>

    <div style="margin-top:10px;">
      <button id="confirm-btn" class="primary" disabled>Start</button>
      <span id="start-hint" class="muted">Verteile alle Punkte & fÃ¼lle Profil aus.</span>
    </div>

    <p class="muted" style="margin-top:10px; font-size:12px;">
      Hinweis: Dieses Spiel ist <strong>Selbstreflexion</strong>, keine Therapie. Inhalte sind anonym & allgemein.
    </p>
  </section>

  <!-- GAME SCREEN -->
  <section id="game-screen" class="hidden">
    <div class="header">
      <h2>RESET</h2>
      <div class="inline">
        <button id="btn-focus">FOKUS: AUS</button>
        <button id="btn-refresh">Optionen aktualisieren</button>
        <button id="btn-exit">Freiwillig beenden</button>
        <button id="btn-restart">Neustart</button>
        <button id="btn-debug">Debug</button>
      </div>
    </div>

    <div class="row cols-3">
      <div class="panel">
        <h3>Karten</h3>
        <div id="options"></div>
      </div>

      <div class="panel">
        <h3>Ereignis-Log</h3>
        <div class="log" id="log"></div>
      </div>

      <div class="panel">
        <h3>Status & Fortschritt</h3>
        <div id="status"></div>
        <div class="sep"></div>
        <h3>Cooldowns</h3>
        <div id="cooldowns"></div>
      </div>
    </div>
  </section>

  <!-- END SCREEN -->
  <section id="end-screen" class="hidden">
    <div class="panel" style="max-width:900px; margin: 10vh auto 0;">
      <h2 id="end-title">Ende</h2>
      <p id="end-summary" class="muted"></p>

      <div class="sep"></div>
      <h3>Reflexionsbericht</h3>
      <div id="end-report" class="muted" style="white-space:pre-wrap; line-height:1.35;"></div>

      <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
        <button id="btn-continue" class="primary">Weiter im Sandbox-Modus</button>
        <button id="btn-reseed">Neu starten (gleicher Seed)</button>
        <button id="btn-download">Run exportieren (JSON)</button>
        <button id="btn-mdc">Maschinencode (Debug)</button>
        <button id="btn-to-start">ZurÃ¼ck zum Start</button>
      </div>
    </div>
  </section>
</div>

<!-- Debug-Panel -->
<div id="debug-panel" class="debug-panel hidden">
  <div class="panel">
    <div style="display:flex; justify-content:space-between; align-items:center;">
      <h3>Diagnose & Debug</h3>
      <button id="debug-close">SchlieÃŸen</button>
    </div>
    <div class="sep"></div>

    <!-- drei Spalten: Health | Logs | Telemetry -->
    <div class="row cols-3">
      <div>
        <h4>Health-Check</h4>
        <div id="debug-health" class="log" style="height:240px;"></div>
      </div>
      <div>
        <h4>System-Logs</h4>
        <div id="debug-logs" class="log" style="height:240px;"></div>
      </div>
      <div>
        <h4>Story-Telemetrie</h4>
        <div id="debug-telemetry" class="log" style="height:240px; white-space:pre-wrap;"></div>
      </div>
    </div>

    <div class="sep"></div>
    <h4>Maschinencode & Export</h4>
    <textarea id="debug-code" rows="6" style="width:100%;"></textarea>
    <div style="margin-top:6px; display:flex; gap:8px; flex-wrap:wrap;">
      <button id="debug-run" class="primary">MDC generieren</button>
      <button id="debug-copy">MDC kopieren</button>
      <button id="debug-export">CSV exportieren</button>
      <span class="muted">â†’ CSV enthÃ¤lt Story-Log (Zeit, Karte, Familie, Outcome, Deltas, Ressourcen â€¦)</span>
    </div>
  </div>
</div>

<!-- Scripts: boot â†’ cards â†’ stories â†’ game -->
<script src="boot.js" defer></script>
<script src="cards.js" defer></script>
<script src="stories.js" defer></script>
<script src="game.js" defer></script>

<!-- Preflight-Hinweis, falls boot.js fehlt -->
<script>
  window.addEventListener('DOMContentLoaded', function(){
    setTimeout(function(){
      if (!window.CH || !window.CH.ui) {
        var w = document.createElement('div');
        w.style.cssText='position:fixed;inset:0;background:rgba(10,13,10,.92);z-index:99998;padding:16px';
        w.innerHTML = '<div class="panel" style="max-width:900px;margin:10vh auto">'+
          '<h3>Hinweis: Debug/Diagnostics nicht geladen</h3><div class="sep"></div>'+
          '<p class="muted">Die Datei <code>boot.js</code> wurde nicht gefunden oder blockiert. '+
          'PrÃ¼fe die Pfadangabe und lade die Seite Ã¼ber HTTP/HTTPS (nicht <code>file://</code>).</p>'+
          '<div style="margin-top:8px"><button id="__pf_close" class="primary">OK</button></div></div>';
        document.body.appendChild(w);
        w.querySelector('#__pf_close').onclick=function(){ w.remove(); };
      }
    }, 0);
  });
</script>
</body>
</html>